{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shabi\\\\Documents\\\\FREEDOM\\\\AI\\\\AI CRM\\\\src\\\\App.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from 'firebase/auth';\nimport { getFirestore, collection, onSnapshot, doc, updateDoc, deleteDoc, addDoc, query, where, Timestamp } from 'firebase/firestore';\nimport { marked } from 'marked';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  // Use a fallback to an empty object if process is not defined, which happens outside of the Node.js environment\n  const env = typeof process !== 'undefined' && process.env ? process.env : {};\n\n  // Log all environment variables at the start\n  console.log(\"All Env Variables:\", env);\n\n  // Use the Firebase projectId as the unique app ID for Firestore paths\n  const firebaseConfig = {\n    apiKey: env.REACT_APP_FIREBASE_API_KEY || \"AIzaSyC3GXJMBCPAhbZFGgavxyRova_Hno0csVA\",\n    authDomain: env.REACT_APP_FIREBASE_AUTH_DOMAIN || \"vitalpulsecrm.firebaseapp.com\",\n    projectId: env.REACT_APP_FIREBASE_PROJECT_ID || \"vitalpulsecrm\",\n    storageBucket: env.REACT_APP_FIREBASE_STORAGE_BUCKET || \"vitalpulsecrm.firebasestorage.app\",\n    messagingSenderId: env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID || \"671657196543\",\n    appId: env.REACT_APP_FIREBASE_APP_ID || \"1:671657196543:web:15a2b69b7371d0b7a8c5ca\",\n    measurementId: env.REACT_APP_FIREBASE_MEASUREMENT_ID || \"G-XXYKEHF990\"\n  };\n  const appId = firebaseConfig.projectId;\n  const [db, setDb] = useState(null);\n  const [auth, setAuth] = useState(null);\n  const [user, setUser] = useState(null);\n  const [accounts, setAccounts] = useState({});\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const [selectedAccount, setSelectedAccount] = useState(null);\n  const dragItem = useRef(null);\n  const funnelStages = [{\n    name: 'Business Intel',\n    color: 'bg-stone-500'\n  }, {\n    name: 'New Leads',\n    color: 'bg-indigo-500'\n  }, {\n    name: 'Qualified Opportunities',\n    color: 'bg-blue-500'\n  }, {\n    name: 'Needs Analysis',\n    color: 'bg-purple-500'\n  }, {\n    name: 'Proposal Sent',\n    color: 'bg-yellow-500'\n  }, {\n    name: 'Negotiation',\n    color: 'bg-orange-500'\n  }, {\n    name: 'Closed Won',\n    color: 'bg-green-500'\n  }, {\n    name: 'Closed Lost',\n    color: 'bg-red-500'\n  }, {\n    name: 'Nurturing',\n    color: 'bg-gray-500'\n  }];\n\n  // Initialize Firebase and set up auth listener on component mount\n  useEffect(() => {\n    try {\n      if (firebaseConfig.apiKey && firebaseConfig.authDomain && firebaseConfig.projectId && firebaseConfig.appId) {\n        const app = initializeApp(firebaseConfig);\n        console.log(\"Firebase Config Loaded:\", firebaseConfig);\n        const firestore = getFirestore(app);\n        const authInstance = getAuth(app);\n        setDb(firestore);\n        setAuth(authInstance);\n        const unsubscribe = onAuthStateChanged(authInstance, currentUser => {\n          setUser(currentUser);\n          setIsLoading(false);\n        });\n        return () => unsubscribe();\n      } else {\n        setError(\"Missing Firebase configâ€”check .env file.\");\n        setIsLoading(false);\n      }\n    } catch (err) {\n      setError(\"Failed to initialize the application.\");\n      setIsLoading(false);\n    }\n  }, [firebaseConfig.apiKey, firebaseConfig.authDomain, firebaseConfig.projectId, firebaseConfig.appId]);\n\n  // Set up Firestore listener after user is authenticated\n  useEffect(() => {\n    if (user && db) {\n      const accountsRef = collection(db, `artifacts/${appId}/users/${user.uid}/accounts`);\n      const q = query(accountsRef);\n      const unsubscribe = onSnapshot(q, snapshot => {\n        const fetchedAccounts = snapshot.docs.map(doc => ({\n          ...doc.data(),\n          id: doc.id\n        }));\n        const organizedAccounts = {};\n        funnelStages.forEach(stage => {\n          const sortedAccounts = fetchedAccounts.filter(acc => acc.stage === stage.name).sort((a, b) => {\n            var _a$nextFollowUpDate, _b$nextFollowUpDate;\n            const dateA = ((_a$nextFollowUpDate = a.nextFollowUpDate) === null || _a$nextFollowUpDate === void 0 ? void 0 : _a$nextFollowUpDate.toDate()) || new Date(8640000000000000);\n            const dateB = ((_b$nextFollowUpDate = b.nextFollowUpDate) === null || _b$nextFollowUpDate === void 0 ? void 0 : _b$nextFollowUpDate.toDate()) || new Date(8640000000000000);\n            return dateA - dateB;\n          });\n          organizedAccounts[stage.name] = sortedAccounts;\n        });\n        setAccounts(organizedAccounts);\n      }, err => {\n        setError(\"Failed to load data.\");\n      });\n      return () => unsubscribe();\n    }\n  }, [user, db, appId, funnelStages]);\n  const handleDragStart = (e, item) => {\n    dragItem.current = item;\n  };\n  const handleDragEnd = async (e, stageName) => {\n    e.preventDefault();\n    if (!dragItem.current || !user) return;\n    try {\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, dragItem.current.id);\n      await updateDoc(docRef, {\n        stage: stageName\n      });\n      dragItem.current = null;\n    } catch (err) {\n      setError(\"Failed to update account stage.\");\n    }\n  };\n  const handleAddAccount = async newAccount => {\n    if (!db || !user) return;\n    try {\n      const collectionRef = collection(db, `artifacts/${appId}/users/${user.uid}/accounts`);\n      await addDoc(collectionRef, {\n        ...newAccount,\n        stage: 'Business Intel',\n        createdAt: Timestamp.now(),\n        notes: [],\n        value: Number(newAccount.value) || 0,\n        monthlyValue: Number(newAccount.monthlyValue) || 0,\n        dealScore: 50,\n        expectedCloseDate: newAccount.expectedCloseDate ? Timestamp.fromDate(new Date(newAccount.expectedCloseDate)) : null,\n        nextFollowUpDate: newAccount.nextFollowUpDate ? Timestamp.fromDate(new Date(newAccount.nextFollowUpDate)) : null\n      });\n      setShowModal(false);\n      setSelectedAccount(null);\n    } catch (err) {\n      setError(\"Failed to add new account.\");\n    }\n  };\n  const handleUpdateAccount = async updatedAccount => {\n    if (!db || !user || !selectedAccount) return;\n    try {\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, selectedAccount.id);\n      await updateDoc(docRef, {\n        ...updatedAccount,\n        value: Number(updatedAccount.value) || 0,\n        monthlyValue: Number(updatedAccount.monthlyValue) || 0,\n        expectedCloseDate: updatedAccount.expectedCloseDate ? Timestamp.fromDate(new Date(updatedAccount.expectedCloseDate)) : null,\n        nextFollowUpDate: updatedAccount.nextFollowUpDate ? Timestamp.fromDate(new Date(updatedAccount.nextFollowUpDate)) : null\n      });\n      setShowModal(false);\n      setSelectedAccount(null);\n    } catch (err) {\n      setError(\"Failed to update account.\");\n    }\n  };\n  const handleDeleteAccount = async accountId => {\n    if (!db || !user) return;\n    try {\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, accountId);\n      await deleteDoc(docRef);\n      setShowModal(false);\n      setSelectedAccount(null);\n    } catch (err) {\n      setError(\"Failed to delete account.\");\n    }\n  };\n\n  // The new function that handles adding notes, now in the parent component\n  const handleAddNoteToAccount = async (accountId, noteText) => {\n    if (!db || !user || !noteText.trim() || !accountId) return false;\n    try {\n      const currentAccount = Object.values(accounts).flat().find(acc => acc.id === accountId);\n      if (!currentAccount) return false;\n      const newNote = {\n        text: noteText,\n        timestamp: new Date().toISOString(),\n        sentiment: 'Neutral' // Default sentiment, can be enhanced with AI analysis\n      };\n      const updatedNotes = [...(currentAccount.notes || []), newNote];\n\n      // Update Firestore\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, accountId);\n      await updateDoc(docRef, {\n        notes: updatedNotes\n      });\n\n      // We don't need to manually update state here, as onSnapshot will do it for us\n      return true;\n    } catch (err) {\n      setError(\"Failed to add note.\");\n      return false;\n    }\n  };\n  const totalPipelineValue = Object.values(accounts).flat().filter(acc => acc.stage !== 'Closed Won' && acc.stage !== 'Closed Lost' && acc.stage !== 'Business Intel').reduce((sum, acc) => sum + (acc.value || 0), 0);\n  const numberOfActiveDeals = Object.values(accounts).flat().filter(acc => acc.stage !== 'Closed Won' && acc.stage !== 'Closed Lost' && acc.stage !== 'Business Intel').length;\n  const upcomingFollowups = Object.values(accounts).flat().filter(acc => {\n    if (!acc.nextFollowUpDate) return false;\n    const today = new Date();\n    const followUpDate = acc.nextFollowUpDate.toDate();\n    const timeDiff = followUpDate.getTime() - today.getTime();\n    const dayDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));\n    return dayDiff >= 0 && dayDiff <= 7;\n  }).length;\n  const getPipelineValues = () => {\n    const values = {};\n    funnelStages.forEach(stage => {\n      values[stage.name] = 0;\n    });\n    Object.values(accounts).flat().forEach(account => {\n      if (account.stage !== 'Closed Won' && account.stage !== 'Closed Lost' && account.stage !== 'Business Intel') {\n        values[account.stage] = (values[account.stage] || 0) + (account.value || 0);\n      }\n    });\n    return values;\n  };\n  const pipelineValues = getPipelineValues();\n  const maxPipelineValue = Math.max(...Object.values(pipelineValues));\n  const handleLogout = async () => {\n    await signOut(auth);\n    setAccounts({});\n    setSelectedAccount(null);\n  };\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col items-center justify-center min-h-screen bg-gray-100\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"animate-spin -ml-1 mr-3 h-10 w-10 text-blue-500\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        fill: \"none\",\n        viewBox: \"0 0 24 24\",\n        children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n          className: \"opacity-25\",\n          cx: \"12\",\n          cy: \"12\",\n          r: \"10\",\n          stroke: \"currentColor\",\n          strokeWidth: \"4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          className: \"opacity-75\",\n          fill: \"currentColor\",\n          d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 text-gray-700\",\n        children: \"Loading CRM...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this);\n  }\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(AuthComponent, {\n      auth: auth\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center min-h-screen text-red-500 text-lg p-4 bg-gray-100\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-gray-100 min-h-screen font-sans antialiased\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"flex items-center justify-between bg-white shadow-sm p-4 rounded-lg mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-gray-800\",\n          children: \"AI Services CRM\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-600\",\n            children: [\"Welcome, \", user.displayName || user.email, \"!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              setSelectedAccount(null);\n              setShowModal(true);\n            },\n            className: \"bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\",\n            children: \"+ Add New Account\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLogout,\n            className: \"bg-red-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-red-700 transition duration-300 ease-in-out\",\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-6 rounded-lg shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm font-medium text-gray-500\",\n            children: \"Total Pipeline Value\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-gray-900 mt-1\",\n            children: [\"$\", totalPipelineValue.toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-6 rounded-lg shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm font-medium text-gray-500\",\n            children: \"Number of Active Deals\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-gray-900 mt-1\",\n            children: numberOfActiveDeals\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-6 rounded-lg shadow-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm font-medium text-gray-500\",\n            children: \"Upcoming Follow-ups (7 days)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-gray-900 mt-1\",\n            children: upcomingFollowups\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white p-6 rounded-lg shadow-sm mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-bold text-gray-800 mb-4\",\n          children: \"Pipeline Value by Stage\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-end h-48 w-full\",\n          children: funnelStages.filter(s => s.name !== 'Closed Won' && s.name !== 'Closed Lost' && s.name !== 'Business Intel').map(stage => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col items-center flex-grow mx-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `w-full rounded-t-lg transition-all duration-500 ${stage.color}`,\n              style: {\n                height: `${maxPipelineValue > 0 ? pipelineValues[stage.name] / maxPipelineValue * 100 : 0}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-2 text-xs text-gray-600 text-center\",\n              children: stage.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm font-semibold text-gray-800 mt-1\",\n              children: [\"$\", (pipelineValues[stage.name] || 0).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 17\n            }, this)]\n          }, stage.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex overflow-x-auto gap-4 py-4 scroll-smooth\",\n        children: funnelStages.map(stage => {\n          var _accounts$stage$name;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-none w-80 min-h-96 bg-gray-200 rounded-lg p-4 shadow-inner\",\n            onDragOver: e => e.preventDefault(),\n            onDrop: e => handleDragEnd(e, stage.name),\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: `text-lg font-semibold text-white px-3 py-1 mb-4 rounded-full ${stage.color}`,\n              children: stage.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4 min-h-80\",\n              children: (_accounts$stage$name = accounts[stage.name]) === null || _accounts$stage$name === void 0 ? void 0 : _accounts$stage$name.map(account => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"cursor-grab bg-white p-4 rounded-lg shadow-md transition duration-200 ease-in-out hover:shadow-lg\",\n                draggable: true,\n                onDragStart: e => handleDragStart(e, account),\n                onClick: () => {\n                  setSelectedAccount(account);\n                  setShowModal(true);\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"font-semibold text-gray-900\",\n                  children: account.companyName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600 truncate\",\n                  children: account.servicesNeeded\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between text-sm mt-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-gray-700 font-bold\",\n                    children: [\"$\", (account.value || 0).toLocaleString()]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `px-2 py-1 text-xs font-semibold rounded-full ${account.dealScore > 80 ? 'bg-green-200 text-green-800' : account.dealScore > 50 ? 'bg-yellow-200 text-yellow-800' : 'bg-red-200 text-red-800'}`,\n                    children: [\"Score: \", account.dealScore]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 21\n                }, this), account.nextFollowUpDate && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-blue-500 mt-2\",\n                  children: [\"Follow up: \", account.nextFollowUpDate.toDate().toLocaleDateString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 23\n                }, this)]\n              }, account.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this)]\n          }, stage.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-xl font-bold text-gray-800\",\n            children: selectedAccount ? 'Edit Account Details' : 'Add New Account'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowModal(false),\n            className: \"text-gray-500 hover:text-gray-700 text-2xl font-bold\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(AccountForm, {\n          account: selectedAccount,\n          onSave: selectedAccount ? handleUpdateAccount : handleAddAccount,\n          onClose: () => setShowModal(false),\n          onDelete: selectedAccount ? handleDeleteAccount : null,\n          onAddNote: handleAddNoteToAccount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"MzFqHw5e13rYFheAYmXd7knIR0I=\");\n_c = App;\nconst AuthComponent = ({\n  auth\n}) => {\n  _s2();\n  const [isLogin, setIsLogin] = useState(true);\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [firstName, setFirstName] = useState('');\n  const [lastName, setLastName] = useState('');\n  const [authError, setAuthError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setAuthError(null);\n    if (!isLogin && password !== confirmPassword) {\n      setAuthError(\"Passwords do not match.\");\n      setLoading(false);\n      return;\n    }\n    try {\n      if (isLogin) {\n        await signInWithEmailAndPassword(auth, email, password);\n      } else {\n        const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n        await updateProfile(userCredential.user, {\n          displayName: `${firstName} ${lastName}`\n        });\n      }\n    } catch (error) {\n      setAuthError(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-xl p-8 w-full max-w-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-center mb-6\",\n        children: isLogin ? 'Login' : 'Sign Up'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this), authError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 text-red-700 text-sm p-3 rounded-lg mb-4\",\n        children: authError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"space-y-4\",\n        children: [!isLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700\",\n              children: \"First Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: firstName,\n              onChange: e => setFirstName(e.target.value),\n              className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\",\n              required: !isLogin\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700\",\n              children: \"Last Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: lastName,\n              onChange: e => setLastName(e.target.value),\n              className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\",\n              required: !isLogin\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            value: email,\n            onChange: e => setEmail(e.target.value),\n            className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: password,\n            onChange: e => setPassword(e.target.value),\n            className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 11\n        }, this), !isLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Confirm Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: confirmPassword,\n            onChange: e => setConfirmPassword(e.target.value),\n            className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\",\n            required: !isLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"w-full bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out\",\n          disabled: loading,\n          children: loading ? 'Processing...' : isLogin ? 'Login' : 'Sign Up'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 text-center\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setIsLogin(!isLogin),\n          className: \"text-sm text-blue-600 hover:underline\",\n          children: isLogin ? 'Need an account? Sign Up' : 'Already have an account? Login'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 411,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthComponent, \"i7tC/ugcN0EhNWmopbYEqMVSwck=\");\n_c2 = AuthComponent;\nconst AccountForm = ({\n  account,\n  onSave,\n  onClose,\n  onDelete,\n  onAddNote\n}) => {\n  _s3();\n  var _account$expectedClos, _account$nextFollowUp;\n  const [formData, setFormData] = useState({\n    companyName: (account === null || account === void 0 ? void 0 : account.companyName) || '',\n    servicesNeeded: (account === null || account === void 0 ? void 0 : account.servicesNeeded) || '',\n    value: (account === null || account === void 0 ? void 0 : account.value) || '',\n    monthlyValue: (account === null || account === void 0 ? void 0 : account.monthlyValue) || '',\n    expectedCloseDate: (account === null || account === void 0 ? void 0 : (_account$expectedClos = account.expectedCloseDate) === null || _account$expectedClos === void 0 ? void 0 : _account$expectedClos.toDate().toISOString().split('T')[0]) || '',\n    nextFollowUpDate: (account === null || account === void 0 ? void 0 : (_account$nextFollowUp = account.nextFollowUpDate) === null || _account$nextFollowUp === void 0 ? void 0 : _account$nextFollowUp.toDate().toISOString().split('T')[0]) || '',\n    contactName: (account === null || account === void 0 ? void 0 : account.contactName) || '',\n    contactTitle: (account === null || account === void 0 ? void 0 : account.contactTitle) || '',\n    contactEmail: (account === null || account === void 0 ? void 0 : account.contactEmail) || '',\n    contactPhone: (account === null || account === void 0 ? void 0 : account.contactPhone) || '',\n    industry: (account === null || account === void 0 ? void 0 : account.industry) || '',\n    website: (account === null || account === void 0 ? void 0 : account.website) || '',\n    companySize: (account === null || account === void 0 ? void 0 : account.companySize) || '',\n    leadSource: (account === null || account === void 0 ? void 0 : account.leadSource) || '',\n    stage: (account === null || account === void 0 ? void 0 : account.stage) || 'Business Intel',\n    notes: (account === null || account === void 0 ? void 0 : account.notes) || [],\n    lostReason: (account === null || account === void 0 ? void 0 : account.lostReason) || '',\n    dealScore: (account === null || account === void 0 ? void 0 : account.dealScore) || 50\n  });\n  const [newNote, setNewNote] = useState('');\n  const [loadingAI, setLoadingAI] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const recognitionRef = useRef(null);\n  const noteRecognitionRef = useRef(null);\n  const [isDictatingNotes, setIsDictatingNotes] = useState(false);\n  const [isNoteProcessing, setIsNoteProcessing] = useState(false);\n  const [dictationStatus, setDictationStatus] = useState('');\n  const [liveTranscript, setLiveTranscript] = useState('');\n  const [emailDraft, setEmailDraft] = useState('');\n  const [agenda, setAgenda] = useState('');\n  const [isAddingAccount, setIsAddingAccount] = useState(false);\n\n  // IMPORTANT: For production, move API keys to secure environment variables.\n  const callGeminiAPI = async (prompt, mimeType = 'text/plain', inlineData = null, responseSchema = null) => {\n    // Use a fallback key for local testing and debug the env value\n    const apiKey = process.env.REACT_APP_GEMINI_API_KEY || 'AIzaSyD65roIJWhoE_BzVIlK4orMuV6Lu0KWeVA';\n    console.log(\"Attempting API call with key:\", {\n      apiKey,\n      envValue: process.env.REACT_APP_GEMINI_API_KEY\n    });\n    if (!apiKey) {\n      console.error(\"Gemini API key is missing or invalid. Env value was:\", process.env.REACT_APP_GEMINI_API_KEY);\n      return null;\n    }\n    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`;\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    let payload = {\n      contents: [{\n        parts: [{\n          text: prompt\n        }]\n      }]\n    };\n    if (inlineData) {\n      payload.contents[0].parts.push({\n        inlineData: {\n          mimeType,\n          data: inlineData\n        }\n      });\n    }\n    if (responseSchema) {\n      payload.generationConfig = {\n        responseMimeType: \"application/json\",\n        responseSchema\n      };\n    }\n    try {\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: headers,\n        body: JSON.stringify(payload)\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      console.log(\"API Response:\", data);\n      return data;\n    } catch (error) {\n      console.error(\"Gemini API call failed:\", error.message);\n      return null;\n    }\n  };\n  const recalculateDealScore = async data => {\n    if (data.stage === 'Closed Won') return 100;\n    if (data.stage === 'Closed Lost') return 0;\n    const allNotes = data.notes.map(note => ({\n      text: note.text,\n      sentiment: note.sentiment\n    }));\n    const prompt = `Based on the following account details, chronological notes, and its current position in the sales funnel, provide a predictive lead score from 0 to 100. A score of 100 indicates a very high probability of closing.\n\n    Consider these primary factors:\n    1. The deal's progression through the sales funnel. This is the most important indicator.\n    2. The combined sentiment of the notes, and the trend of that sentiment over time. Recent positive sentiment is more important than old negative sentiment.\n    3. The deal's value and other details including the setup fee and monthly subscription.\n\n    Account Details:\n    Current Stage: ${data.stage}\n    Deal Value: $${data.value}\n    Monthly Value: $${data.monthlyValue}\n    Company Name: ${data.companyName}\n\n    Chronological History (Notes):\n    ${JSON.stringify(allNotes, null, 2)}\n    \n    Return only the integer score as a number.`;\n    const scoreText = await callGeminiAPI(prompt, 'text/plain', null, {\n      type: \"NUMBER\"\n    });\n    return scoreText ? parseFloat(scoreText) : 50;\n  };\n  const handleDraftEmail = async () => {\n    setLoadingAI(true);\n    setDictationStatus('Drafting email...');\n    const notesSummary = formData.notes.length > 0 ? formData.notes.map(note => note.text).join('\\n') : 'No notes available. The last interaction was for ' + formData.stage;\n    const prompt = `You are a professional sales representative. Draft a concise and personalized follow-up email for a client. The email should be polite, reference the previous interactions, and suggest a clear next step.\n\n    Account Details:\n    Company Name: ${formData.companyName}\n    Services Needed: ${formData.servicesNeeded}\n    Current Stage: ${formData.stage}\n    Primary Contact: ${formData.contactName}\n    Notes from previous interactions:\n    ${notesSummary}\n\n    Draft the email, starting with a subject line. Do not include a signature.`;\n    const draft = await callGeminiAPI(prompt);\n    if (draft) {\n      setEmailDraft(draft);\n    } else {\n      setEmailDraft(\"Failed to generate email draft. Please try again.\");\n    }\n    setLoadingAI(false);\n    setDictationStatus('');\n  };\n  const handleGenerateAgenda = async () => {\n    setLoadingAI(true);\n    setDictationStatus('Generating agenda...');\n    const notesSummary = formData.notes.length > 0 ? formData.notes.map(note => note.text).join('\\n') : 'No notes available.';\n    const prompt = `You are a professional sales manager. Generate a concise and scannable meeting agenda for the next sales call. The agenda should be based on the account details and historical notes.\n\n    Format the response with markdown. Use a single heading, followed by bullet points for each section. Keep each section to a maximum of 3-4 bullet points.\n\n    ## Meeting Agenda: ${formData.companyName} - ${formData.servicesNeeded}\n\n    **Objective**\n    - [Briefly state the goal of the meeting based on the current stage.]\n\n    **Key Discussion Points**\n    - [Key topics pulled from notes or next steps in the sales funnel.]\n    - [Address any customer concerns mentioned in the notes.]\n    - [Review of the last interaction.]\n\n    **Next Steps**\n    - [Actionable tasks or commitments to close the deal.]\n\n    Account Details:\n    Current Stage: ${formData.stage}\n    Notes from previous interactions:\n    ${notesSummary}\n    \n    Draft the agenda using the structure and content above. Do not include any other text.`;\n    const generatedAgenda = await callGeminiAPI(prompt);\n    if (generatedAgenda) {\n      setAgenda(marked.parse(generatedAgenda));\n    } else {\n      setAgenda(\"Failed to generate meeting agenda. Please try again.\");\n    }\n    setLoadingAI(false);\n    setDictationStatus('');\n  };\n  const handleScanBusinessCard = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    setLoadingAI(true);\n    setDictationStatus('Scanning card...');\n    const reader = new FileReader();\n    reader.onload = async () => {\n      const base64Data = reader.result.split(',')[1];\n      const prompt = \"Extract the following information from this business card and return it as a JSON object with keys: companyName, contactName, contactTitle, contactEmail, contactPhone. Only return the JSON object, nothing else.\";\n      const jsonText = await callGeminiAPI(prompt, file.type, base64Data);\n      if (jsonText) {\n        const parsedData = JSON.parse(jsonText.replace(/```json\\n|\\n```/g, ''));\n        setFormData(prev => ({\n          ...prev,\n          ...parsedData,\n          contactName: parsedData.contactName || '',\n          contactEmail: parsedData.contactEmail || '',\n          contactPhone: parsedData.contactPhone || '',\n          contactTitle: parsedData.contactTitle || '',\n          companyName: parsedData.companyName || ''\n        }));\n      } else {\n        console.error(\"AI extraction failed: No text in response.\");\n      }\n      setLoadingAI(false);\n      setDictationStatus('');\n    };\n    reader.readAsDataURL(file);\n  };\n  const handleDictate = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error(\"Speech recognition not supported in this browser.\");\n      return;\n    }\n    const SpeechRecognition = window.webkitSpeechRecognition;\n    recognitionRef.current = new SpeechRecognition();\n    recognitionRef.current.continuous = true;\n    recognitionRef.current.interimResults = true;\n    recognitionRef.current.lang = 'en-US';\n    let finalTranscript = '';\n    recognitionRef.current.onstart = () => {\n      setLoadingAI(true);\n      setDictationStatus('Listening...');\n      setLiveTranscript('');\n      finalTranscript = '';\n    };\n    recognitionRef.current.onresult = event => {\n      let interimTranscript = '';\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\n        if (event.results[i].isFinal) {\n          finalTranscript += event.results[i][0].transcript;\n        } else {\n          interimTranscript += event.results[i][0].transcript;\n        }\n      }\n      setLiveTranscript(finalTranscript + interimTranscript);\n    };\n    recognitionRef.current.onend = async () => {\n      recognitionRef.current = null;\n      if (finalTranscript.trim() === '') {\n        setLoadingAI(false);\n        setDictationStatus('');\n        console.warn(\"Speech recognition ended with no final transcript.\");\n        return;\n      }\n      setDictationStatus('Thinking...');\n      const prompt = `Based on the following transcript, extract key information and return a JSON object with keys for companyName, servicesNeeded, value (as a number), monthlyValue (as a number), contactName, contactTitle, contactEmail, and contactPhone. If a value is not found, use a null. Do not include any other text besides the JSON. Transcript: \"${finalTranscript.trim()}\"`;\n      const jsonText = await callGeminiAPI(prompt, 'text/plain', null, {\n        type: \"OBJECT\",\n        properties: {\n          \"companyName\": {\n            \"type\": \"STRING\"\n          },\n          \"servicesNeeded\": {\n            \"type\": \"STRING\"\n          },\n          \"value\": {\n            \"type\": \"NUMBER\"\n          },\n          \"monthlyValue\": {\n            \"type\": \"NUMBER\"\n          },\n          \"contactName\": {\n            \"type\": \"STRING\"\n          },\n          \"contactTitle\": {\n            \"type\": \"STRING\"\n          },\n          \"contactEmail\": {\n            \"type\": \"STRING\"\n          },\n          \"contactPhone\": {\n            \"type\": \"STRING\"\n          }\n        }\n      });\n      if (jsonText) {\n        const parsedData = JSON.parse(jsonText);\n        setFormData(prev => ({\n          ...prev,\n          ...parsedData,\n          value: parsedData.value || '',\n          monthlyValue: parsedData.monthlyValue || ''\n        }));\n      } else {\n        console.error(\"AI parsing failed: No text in response.\");\n      }\n      setLoadingAI(false);\n      setDictationStatus('');\n    };\n    recognitionRef.current.onerror = event => {\n      if (event.error === 'no-speech') {\n        console.warn(\"Speech recognition stopped due to no speech detected.\");\n      } else {\n        console.error(\"Speech recognition error:\", event.error);\n      }\n      setDictationStatus('');\n      setLoadingAI(false);\n    };\n    recognitionRef.current.start();\n  };\n  const handleStopDictate = () => {\n    if (recognitionRef.current) {\n      recognitionRef.current.stop();\n    }\n  };\n  const handleNoteDictate = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error(\"Speech recognition not supported in this browser.\");\n      return;\n    }\n    const SpeechRecognition = window.webkitSpeechRecognition;\n    noteRecognitionRef.current = new SpeechRecognition();\n    noteRecognitionRef.current.continuous = true;\n    noteRecognitionRef.current.interimResults = true;\n    noteRecognitionRef.current.lang = 'en-US';\n    let finalTranscript = '';\n    setIsDictatingNotes(true);\n    setNewNote('');\n    setLiveTranscript('');\n    setDictationStatus('Listening...');\n    noteRecognitionRef.current.onresult = event => {\n      let interimTranscript = '';\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\n        if (event.results[i].isFinal) {\n          finalTranscript += event.results[i][0].transcript;\n        } else {\n          interimTranscript += event.results[i][0].transcript;\n        }\n      }\n      setLiveTranscript(finalTranscript + interimTranscript);\n    };\n    noteRecognitionRef.current.onend = async () => {\n      setIsDictatingNotes(false);\n      noteRecognitionRef.current = null;\n      if (finalTranscript.trim() === '') {\n        setNewNote('');\n        setIsNoteProcessing(false);\n        setDictationStatus('');\n        console.warn(\"Speech recognition ended with no final transcript.\");\n        return;\n      }\n      setDictationStatus('Processing...');\n      const transcript = finalTranscript.trim();\n      const prompt = `Analyze the following transcript of a sales call or meeting. Extract and structure the information into three categories: 'summary' (as bullet points), 'actions' (as a list of tasks that need to be done), and 'concerns' (customer issues or questions). Also, classify the overall sentiment of the conversation as 'Positive', 'Negative', or 'Neutral'. Return the result as a JSON object with the keys 'summary', 'actions', 'concerns', and 'sentiment'. If a category has no information, use an empty array. Do not include any text outside of the JSON object.\n          Transcript: \"${transcript}\"`;\n      const jsonText = await callGeminiAPI(prompt, 'text/plain', null, {\n        type: \"OBJECT\",\n        properties: {\n          \"summary\": {\n            \"type\": \"ARRAY\",\n            \"items\": {\n              \"type\": \"STRING\"\n            }\n          },\n          \"actions\": {\n            \"type\": \"ARRAY\",\n            \"items\": {\n              \"type\": \"STRING\"\n            }\n          },\n          \"concerns\": {\n            \"type\": \"ARRAY\",\n            \"items\": {\n              \"type\": \"STRING\"\n            }\n          },\n          \"sentiment\": {\n            \"type\": \"STRING\"\n          }\n        }\n      });\n      if (jsonText) {\n        const parsedData = JSON.parse(jsonText);\n        let formattedNote = '';\n        const sentimentEmoji = parsedData.sentiment === 'Positive' ? 'ðŸ˜Š' : parsedData.sentiment === 'Negative' ? 'ðŸ˜ž' : 'ðŸ˜';\n        formattedNote += `**Sentiment:** ${parsedData.sentiment} ${sentimentEmoji}\\n\\n`;\n        if (parsedData.summary.length > 0) {\n          formattedNote += \"**Summary:**\\n\" + parsedData.summary.map(item => `â€¢ ${item}`).join(\"\\n\");\n        }\n        if (parsedData.actions.length > 0) {\n          formattedNote += (formattedNote ? \"\\n\\n\" : \"\") + \"**Action Items:**\\n\" + parsedData.actions.map(item => `â€¢ ${item}`).join(\"\\n\");\n        }\n        if (parsedData.concerns.length > 0) {\n          formattedNote += (formattedNote ? \"\\n\\n\" : \"\") + \"**Customer Concerns:**\\n\" + parsedData.concerns.map(item => `â€¢ ${item}`).join(\"\\n\");\n        }\n        setNewNote(formattedNote);\n      } else {\n        setNewNote('Failed to process note.');\n      }\n      setIsNoteProcessing(false);\n      setDictationStatus('');\n      setLiveTranscript('');\n    };\n    noteRecognitionRef.current.onerror = event => {\n      if (event.error === 'no-speech') {\n        console.warn(\"Speech recognition for notes stopped due to no speech detected.\");\n      } else {\n        console.error(\"Speech recognition error:\", event.error);\n      }\n      setIsDictatingNotes(false);\n      setIsNoteProcessing(false);\n      setDictationStatus('');\n      setNewNote('');\n      setLiveTranscript('');\n    };\n    noteRecognitionRef.current.start();\n  };\n  const handleStopNoteDictate = () => {\n    if (noteRecognitionRef.current) {\n      noteRecognitionRef.current.stop();\n    }\n  };\n  const handleEditNote = (index, newNoteContent) => {\n    const updatedNotes = [...formData.notes];\n    updatedNotes[index] = {\n      ...updatedNotes[index],\n      text: newNoteContent\n    };\n    setFormData(prev => ({\n      ...prev,\n      notes: updatedNotes\n    }));\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const handleAddNote = async () => {\n    if (newNote.trim() === '' || !selectedAccount) return;\n\n    // Create a new note object with a timestamp and the user's name\n    const noteWithTimestamp = {\n      text: newNote,\n      timestamp: new Date().toISOString()\n    };\n\n    // Create a new notes array by copying the old ones and adding the new one\n    const updatedNotes = [...(selectedAccount.notes || []), noteWithTimestamp];\n\n    // Get a reference to the document to be updated\n    const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, selectedAccount.id);\n\n    // Update the notes field in Firestore\n    await updateDoc(docRef, {\n      notes: updatedNotes\n    });\n\n    // Update the local state with the new note and clear the input field\n    setSelectedAccount(prev => ({\n      ...prev,\n      notes: updatedNotes\n    }));\n    setNewNote('');\n  };\n  const handleSave = async e => {\n    e.preventDefault();\n    setIsAddingAccount(true);\n    const updatedFormData = {\n      ...formData\n    };\n    if (updatedFormData.stage === 'Business Intel' && !updatedFormData.servicesNeeded) {\n      updatedFormData.servicesNeeded = 'N/A';\n    }\n    try {\n      const newDealScore = await recalculateDealScore(updatedFormData);\n      updatedFormData.dealScore = newDealScore;\n      await onSave(updatedFormData);\n    } finally {\n      setIsAddingAccount(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSave,\n    className: \"space-y-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center space-x-4 mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: `relative flex items-center px-4 py-2 rounded-full cursor-pointer transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: handleScanBusinessCard,\n          className: \"absolute inset-0 opacity-0 cursor-pointer\",\n          disabled: loadingAI\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 946,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          className: \"h-5 w-5 mr-2\",\n          viewBox: \"0 0 20 20\",\n          fill: \"currentColor\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            fillRule: \"evenodd\",\n            d: \"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\",\n            clipRule: \"evenodd\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 948,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 947,\n          columnNumber: 11\n        }, this), \"Scan Business Card\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 945,\n        columnNumber: 9\n      }, this), !recognitionRef.current ? /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleDictate,\n        className: `flex items-center px-4 py-2 rounded-full transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`,\n        disabled: loadingAI,\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          className: \"h-5 w-5 mr-2\",\n          viewBox: \"0 0 20 20\",\n          fill: \"currentColor\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H2V5z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 955,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 954,\n          columnNumber: 13\n        }, this), \"Dictate\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 953,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleStopDictate,\n        className: \"flex items-center px-4 py-2 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors\",\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          className: \"h-5 w-5 mr-2 animate-pulse\",\n          viewBox: \"0 0 20 20\",\n          fill: \"currentColor\",\n          children: /*#__PURE__*/_jsxDEV(\"circle\", {\n            cx: \"10\",\n            cy: \"10\",\n            r: \"8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 962,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 961,\n          columnNumber: 13\n        }, this), \"Stop\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 960,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 944,\n      columnNumber: 7\n    }, this), dictationStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-blue-600 text-sm font-semibold mb-4\",\n      children: dictationStatus\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 969,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Company Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 973,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"companyName\",\n          value: formData.companyName,\n          onChange: handleChange,\n          required: true,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 974,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 972,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Services Needed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 977,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"servicesNeeded\",\n          value: formData.servicesNeeded,\n          onChange: handleChange,\n          required: true,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 978,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 976,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Deal Value ($)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 981,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"value\",\n          value: formData.value,\n          onChange: handleChange,\n          required: true,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 982,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 980,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Monthly Value ($)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"monthlyValue\",\n          value: formData.monthlyValue,\n          onChange: handleChange,\n          required: true,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 986,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 984,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Expected Close Date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 989,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          name: \"expectedCloseDate\",\n          value: formData.expectedCloseDate,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 990,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 988,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Next Follow-up Date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 993,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          name: \"nextFollowUpDate\",\n          value: formData.nextFollowUpDate,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 994,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 992,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Primary Contact\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"contactName\",\n          value: formData.contactName,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 998,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 996,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Contact Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1001,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"contactTitle\",\n          value: formData.contactTitle,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1002,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1000,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Contact Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1005,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"contactEmail\",\n          value: formData.contactEmail,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1006,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1004,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Contact Phone\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1009,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"tel\",\n          name: \"contactPhone\",\n          value: formData.contactPhone,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1010,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1008,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Industry\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1013,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"industry\",\n          value: formData.industry,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1014,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1012,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Lead Source\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1017,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"leadSource\",\n          value: formData.leadSource,\n          onChange: handleChange,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1018,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1016,\n        columnNumber: 9\n      }, this), formData.stage === 'Closed Lost' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"md:col-span-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Reason for Losing\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1022,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"lostReason\",\n          value: formData.lostReason,\n          onChange: handleChange,\n          required: true,\n          className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\",\n          rows: \"3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1023,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1021,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 971,\n      columnNumber: 7\n    }, this), account && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleDraftEmail,\n        className: \"flex items-center justify-center w-full bg-indigo-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-indigo-700 transition duration-300 ease-in-out\",\n        disabled: loadingAI,\n        children: \"\\u2728 AI Draft Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1030,\n        columnNumber: 11\n      }, this), emailDraft && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-sm font-semibold mb-2\",\n          children: \"Email Draft:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1040,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: emailDraft,\n          readOnly: true,\n          className: \"w-full text-sm text-gray-800 bg-transparent border-none focus:outline-none\",\n          rows: \"10\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1041,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => {\n            try {\n              navigator.clipboard.writeText(emailDraft);\n            } catch (e) {\n              const tempInput = document.createElement('textarea');\n              tempInput.value = emailDraft;\n              document.body.appendChild(tempInput);\n              tempInput.select();\n              document.execCommand('copy');\n              document.body.removeChild(tempInput);\n            }\n          },\n          className: \"mt-2 text-xs text-blue-600 hover:underline\",\n          children: \"Copy to Clipboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1047,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1039,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1029,\n      columnNumber: 9\n    }, this), account && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleGenerateAgenda,\n        className: \"flex items-center justify-center w-full bg-teal-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-teal-700 transition duration-300 ease-in-out\",\n        disabled: loadingAI,\n        children: \"\\u2728 AI Generate Agenda\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1072,\n        columnNumber: 11\n      }, this), agenda && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-sm font-semibold mb-2\",\n          children: \"Meeting Agenda:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1082,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"prose prose-sm w-full max-w-none text-sm text-gray-800 bg-transparent border-none focus:outline-none\",\n          dangerouslySetInnerHTML: {\n            __html: agenda\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1083,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => {\n            try {\n              navigator.clipboard.writeText(agenda);\n            } catch (e) {\n              const tempInput = document.createElement('textarea');\n              tempInput.value = agenda;\n              document.body.appendChild(tempInput);\n              tempInput.select();\n              document.execCommand('copy');\n              document.body.removeChild(tempInput);\n            }\n          },\n          className: \"mt-2 text-xs text-blue-600 hover:underline\",\n          children: \"Copy to Clipboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1087,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1081,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1071,\n      columnNumber: 9\n    }, this), account && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"block text-sm font-medium text-gray-700\",\n        children: \"Activity & Notes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1112,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border border-gray-300 rounded-md p-3 max-h-48 overflow-y-auto mt-1\",\n        children: formData.notes.map((note, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-700 mb-2 p-2 bg-gray-50 rounded-md group relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: note.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1116,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-400 mt-1\",\n            children: [new Date(note.timestamp).toLocaleString(), \" | \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `font-semibold ${note.sentiment === 'Positive' ? 'text-green-600' : note.sentiment === 'Negative' ? 'text-red-600' : 'text-gray-600'}`,\n              children: note.sentiment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1117,\n              columnNumber: 105\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1117,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1115,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center mt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: isDictatingNotes ? liveTranscript : newNote,\n          onChange: e => setNewNote(e.target.value),\n          placeholder: isDictatingNotes ? 'Speaking...' : isNoteProcessing ? 'Processing...' : 'Add a new note...',\n          className: \"flex-grow rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\",\n          disabled: isNoteProcessing,\n          rows: isDictatingNotes ? 4 : 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1122,\n          columnNumber: 13\n        }, this), !isDictatingNotes ? /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleNoteDictate,\n          className: `ml-2 flex items-center px-4 py-2 rounded-full transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-blue-600 text-white hover:bg-blue-700'}`,\n          disabled: loadingAI || isNoteProcessing,\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-5 w-5\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M7 4a3 3 0 00-3 3v6a3 3 0 003 3h6a3 3 0 003-3V7a3 3 0 00-3-3H7zm0 2a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1V7a1 1 0 00-1-1H7z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1138,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1137,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1131,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleStopNoteDictate,\n          className: \"ml-2 flex items-center px-4 py-2 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-5 w-5 animate-pulse\",\n            viewBox: \"0 0 20 20\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"circle\", {\n              cx: \"10\",\n              cy: \"10\",\n              r: \"8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1148,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1147,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1142,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => onAddNote(account.id, newNote),\n          className: \"ml-2 bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out\",\n          disabled: isNoteProcessing || isDictatingNotes || !newNote.trim(),\n          children: \"Add Note\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1152,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1121,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1111,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end space-x-2 mt-6\",\n      children: [onDelete && /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: () => setShowDeleteConfirm(true),\n        className: \"bg-red-600 text-white px-6 py-3 rounded-full shadow-md hover:bg-red-700 transition duration-300 ease-in-out\",\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1166,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: onClose,\n        className: \"bg-gray-300 text-gray-800 px-6 py-3 rounded-full shadow-md hover:bg-gray-400 transition duration-300 ease-in-out\",\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"bg-green-600 text-white px-6 py-3 rounded-full shadow-md hover:bg-green-700 transition duration-300 ease-in-out\",\n        disabled: isAddingAccount,\n        children: isAddingAccount ? /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"animate-spin h-5 w-5 text-white\",\n          xmlns: \"http://www.w3.org/2000/svg\",\n          fill: \"none\",\n          viewBox: \"0 0 24 24\",\n          children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n            className: \"opacity-25\",\n            cx: \"12\",\n            cy: \"12\",\n            r: \"10\",\n            stroke: \"currentColor\",\n            strokeWidth: \"4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1188,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            className: \"opacity-75\",\n            fill: \"currentColor\",\n            d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1189,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1187,\n          columnNumber: 13\n        }, this) : account ? 'Save Changes' : 'Add Account'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1181,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1164,\n      columnNumber: 7\n    }, this), showDeleteConfirm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-xl w-full max-w-sm p-6 relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-bold text-gray-800 mb-4\",\n          children: \"Confirm Deletion\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1200,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: \"Are you sure you want to delete this account? This action cannot be undone.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1201,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => setShowDeleteConfirm(false),\n            className: \"bg-gray-300 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-400 transition duration-300\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1203,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => {\n              onDelete(account.id);\n              setShowDeleteConfirm(false);\n            },\n            className: \"bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition duration-300\",\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1210,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1202,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1199,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1198,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 943,\n    columnNumber: 5\n  }, this);\n};\n_s3(AccountForm, \"j+ATnKAaan/Pi0kJjEwm2VuBAZI=\");\n_c3 = AccountForm;\nexport default App;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"App\");\n$RefreshReg$(_c2, \"AuthComponent\");\n$RefreshReg$(_c3, \"AccountForm\");","map":{"version":3,"names":["React","useState","useEffect","useRef","initializeApp","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","updateProfile","getFirestore","collection","onSnapshot","doc","updateDoc","deleteDoc","addDoc","query","where","Timestamp","marked","jsxDEV","_jsxDEV","App","_s","env","process","console","log","firebaseConfig","apiKey","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","measurementId","REACT_APP_FIREBASE_MEASUREMENT_ID","db","setDb","auth","setAuth","user","setUser","accounts","setAccounts","isLoading","setIsLoading","error","setError","showModal","setShowModal","selectedAccount","setSelectedAccount","dragItem","funnelStages","name","color","app","firestore","authInstance","unsubscribe","currentUser","err","accountsRef","uid","q","snapshot","fetchedAccounts","docs","map","data","id","organizedAccounts","forEach","stage","sortedAccounts","filter","acc","sort","a","b","_a$nextFollowUpDate","_b$nextFollowUpDate","dateA","nextFollowUpDate","toDate","Date","dateB","handleDragStart","e","item","current","handleDragEnd","stageName","preventDefault","docRef","handleAddAccount","newAccount","collectionRef","createdAt","now","notes","value","Number","monthlyValue","dealScore","expectedCloseDate","fromDate","handleUpdateAccount","updatedAccount","handleDeleteAccount","accountId","handleAddNoteToAccount","noteText","trim","currentAccount","Object","values","flat","find","newNote","text","timestamp","toISOString","sentiment","updatedNotes","totalPipelineValue","reduce","sum","numberOfActiveDeals","length","upcomingFollowups","today","followUpDate","timeDiff","getTime","dayDiff","Math","ceil","getPipelineValues","account","pipelineValues","maxPipelineValue","max","handleLogout","className","children","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","d","AuthComponent","displayName","email","onClick","toLocaleString","s","style","height","_accounts$stage$name","onDragOver","onDrop","draggable","onDragStart","companyName","servicesNeeded","toLocaleDateString","AccountForm","onSave","onClose","onDelete","onAddNote","_c","_s2","isLogin","setIsLogin","setEmail","password","setPassword","confirmPassword","setConfirmPassword","firstName","setFirstName","lastName","setLastName","authError","setAuthError","loading","setLoading","handleSubmit","userCredential","message","onSubmit","type","onChange","target","required","disabled","_c2","_s3","_account$expectedClos","_account$nextFollowUp","formData","setFormData","split","contactName","contactTitle","contactEmail","contactPhone","industry","website","companySize","leadSource","lostReason","setNewNote","loadingAI","setLoadingAI","showDeleteConfirm","setShowDeleteConfirm","recognitionRef","noteRecognitionRef","isDictatingNotes","setIsDictatingNotes","isNoteProcessing","setIsNoteProcessing","dictationStatus","setDictationStatus","liveTranscript","setLiveTranscript","emailDraft","setEmailDraft","agenda","setAgenda","isAddingAccount","setIsAddingAccount","callGeminiAPI","prompt","mimeType","inlineData","responseSchema","REACT_APP_GEMINI_API_KEY","envValue","apiUrl","headers","payload","contents","parts","push","generationConfig","responseMimeType","response","fetch","method","body","JSON","stringify","ok","Error","status","json","recalculateDealScore","allNotes","note","scoreText","parseFloat","handleDraftEmail","notesSummary","join","draft","handleGenerateAgenda","generatedAgenda","parse","handleScanBusinessCard","file","files","reader","FileReader","onload","base64Data","result","jsonText","parsedData","replace","prev","readAsDataURL","handleDictate","window","SpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","finalTranscript","onstart","onresult","event","interimTranscript","i","resultIndex","results","isFinal","transcript","onend","warn","properties","onerror","start","handleStopDictate","stop","handleNoteDictate","formattedNote","sentimentEmoji","summary","actions","concerns","handleStopNoteDictate","handleEditNote","index","newNoteContent","handleChange","handleAddNote","noteWithTimestamp","handleSave","updatedFormData","newDealScore","accept","fillRule","clipRule","rows","readOnly","navigator","clipboard","writeText","tempInput","document","createElement","appendChild","select","execCommand","removeChild","dangerouslySetInnerHTML","__html","placeholder","_c3","$RefreshReg$"],"sources":["C:/Users/shabi/Documents/FREEDOM/AI/AI CRM/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from 'firebase/auth';\r\nimport { getFirestore, collection, onSnapshot, doc, updateDoc, deleteDoc, addDoc, query, where, Timestamp } from 'firebase/firestore';\r\nimport { marked } from 'marked';\r\n\r\nconst App = () => {\r\n  // Use a fallback to an empty object if process is not defined, which happens outside of the Node.js environment\r\n  const env = typeof process !== 'undefined' && process.env ? process.env : {};\r\n\r\n  // Log all environment variables at the start\r\n  console.log(\"All Env Variables:\", env);\r\n\r\n  // Use the Firebase projectId as the unique app ID for Firestore paths\r\n  const firebaseConfig = {\r\n  apiKey: env.REACT_APP_FIREBASE_API_KEY || \"AIzaSyC3GXJMBCPAhbZFGgavxyRova_Hno0csVA\",\r\n  authDomain: env.REACT_APP_FIREBASE_AUTH_DOMAIN || \"vitalpulsecrm.firebaseapp.com\",\r\n  projectId: env.REACT_APP_FIREBASE_PROJECT_ID || \"vitalpulsecrm\",\r\n  storageBucket: env.REACT_APP_FIREBASE_STORAGE_BUCKET || \"vitalpulsecrm.firebasestorage.app\",\r\n  messagingSenderId: env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID || \"671657196543\",\r\n  appId: env.REACT_APP_FIREBASE_APP_ID || \"1:671657196543:web:15a2b69b7371d0b7a8c5ca\",\r\n  measurementId: env.REACT_APP_FIREBASE_MEASUREMENT_ID || \"G-XXYKEHF990\",\r\n};\r\n  const appId = firebaseConfig.projectId;\r\n\r\n  const [db, setDb] = useState(null);\r\n  const [auth, setAuth] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n  const [accounts, setAccounts] = useState({});\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [selectedAccount, setSelectedAccount] = useState(null);\r\n  const dragItem = useRef(null);\r\n\r\n  const funnelStages = [\r\n    { name: 'Business Intel', color: 'bg-stone-500' },\r\n    { name: 'New Leads', color: 'bg-indigo-500' },\r\n    { name: 'Qualified Opportunities', color: 'bg-blue-500' },\r\n    { name: 'Needs Analysis', color: 'bg-purple-500' },\r\n    { name: 'Proposal Sent', color: 'bg-yellow-500' },\r\n    { name: 'Negotiation', color: 'bg-orange-500' },\r\n    { name: 'Closed Won', color: 'bg-green-500' },\r\n    { name: 'Closed Lost', color: 'bg-red-500' },\r\n    { name: 'Nurturing', color: 'bg-gray-500' },\r\n  ];\r\n\r\n  // Initialize Firebase and set up auth listener on component mount\r\n  useEffect(() => {\r\n    try {\r\n      if (\r\n        firebaseConfig.apiKey &&\r\n        firebaseConfig.authDomain &&\r\n        firebaseConfig.projectId &&\r\n        firebaseConfig.appId\r\n      ) {\r\n        const app = initializeApp(firebaseConfig);\r\n        console.log(\"Firebase Config Loaded:\", firebaseConfig);\r\n        const firestore = getFirestore(app);\r\n        const authInstance = getAuth(app);\r\n        setDb(firestore);\r\n        setAuth(authInstance);\r\n\r\n        const unsubscribe = onAuthStateChanged(authInstance, (currentUser) => {\r\n          setUser(currentUser);\r\n          setIsLoading(false);\r\n        });\r\n        return () => unsubscribe();\r\n      } else {\r\n  setError(\"Missing Firebase configâ€”check .env file.\");\r\n  setIsLoading(false);\r\n}\r\n    } catch (err) {\r\n      setError(\"Failed to initialize the application.\");\r\n      setIsLoading(false);\r\n    }\r\n  }, [firebaseConfig.apiKey, firebaseConfig.authDomain, firebaseConfig.projectId, firebaseConfig.appId]);\r\n\r\n  // Set up Firestore listener after user is authenticated\r\n  useEffect(() => {\r\n    if (user && db) {\r\n      const accountsRef = collection(db, `artifacts/${appId}/users/${user.uid}/accounts`);\r\n      const q = query(accountsRef);\r\n\r\n      const unsubscribe = onSnapshot(q, (snapshot) => {\r\n        const fetchedAccounts = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));\r\n        const organizedAccounts = {};\r\n        funnelStages.forEach(stage => {\r\n          const sortedAccounts = fetchedAccounts.filter(acc => acc.stage === stage.name)\r\n            .sort((a, b) => {\r\n              const dateA = a.nextFollowUpDate?.toDate() || new Date(8640000000000000);\r\n              const dateB = b.nextFollowUpDate?.toDate() || new Date(8640000000000000);\r\n              return dateA - dateB;\r\n            });\r\n          organizedAccounts[stage.name] = sortedAccounts;\r\n        });\r\n        setAccounts(organizedAccounts);\r\n      }, (err) => {\r\n        setError(\"Failed to load data.\");\r\n      });\r\n\r\n      return () => unsubscribe();\r\n    }\r\n  }, [user, db, appId, funnelStages]);\r\n\r\n  const handleDragStart = (e, item) => {\r\n    dragItem.current = item;\r\n  };\r\n\r\n  const handleDragEnd = async (e, stageName) => {\r\n    e.preventDefault();\r\n    if (!dragItem.current || !user) return;\r\n    try {\r\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, dragItem.current.id);\r\n      await updateDoc(docRef, { stage: stageName });\r\n      dragItem.current = null;\r\n    } catch (err) {\r\n      setError(\"Failed to update account stage.\");\r\n    }\r\n  };\r\n\r\n  const handleAddAccount = async (newAccount) => {\r\n    if (!db || !user) return;\r\n    try {\r\n      const collectionRef = collection(db, `artifacts/${appId}/users/${user.uid}/accounts`);\r\n      await addDoc(collectionRef, {\r\n        ...newAccount,\r\n        stage: 'Business Intel',\r\n        createdAt: Timestamp.now(),\r\n        notes: [],\r\n        value: Number(newAccount.value) || 0,\r\n        monthlyValue: Number(newAccount.monthlyValue) || 0,\r\n        dealScore: 50,\r\n        expectedCloseDate: newAccount.expectedCloseDate ? Timestamp.fromDate(new Date(newAccount.expectedCloseDate)) : null,\r\n        nextFollowUpDate: newAccount.nextFollowUpDate ? Timestamp.fromDate(new Date(newAccount.nextFollowUpDate)) : null,\r\n      });\r\n      setShowModal(false);\r\n      setSelectedAccount(null);\r\n    } catch (err) {\r\n      setError(\"Failed to add new account.\");\r\n    }\r\n  };\r\n\r\n  const handleUpdateAccount = async (updatedAccount) => {\r\n    if (!db || !user || !selectedAccount) return;\r\n    try {\r\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, selectedAccount.id);\r\n      await updateDoc(docRef, {\r\n        ...updatedAccount,\r\n        value: Number(updatedAccount.value) || 0,\r\n        monthlyValue: Number(updatedAccount.monthlyValue) || 0,\r\n        expectedCloseDate: updatedAccount.expectedCloseDate ? Timestamp.fromDate(new Date(updatedAccount.expectedCloseDate)) : null,\r\n        nextFollowUpDate: updatedAccount.nextFollowUpDate ? Timestamp.fromDate(new Date(updatedAccount.nextFollowUpDate)) : null,\r\n      });\r\n      setShowModal(false);\r\n      setSelectedAccount(null);\r\n    } catch (err) {\r\n      setError(\"Failed to update account.\");\r\n    }\r\n  };\r\n\r\n  const handleDeleteAccount = async (accountId) => {\r\n    if (!db || !user) return;\r\n    try {\r\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, accountId);\r\n      await deleteDoc(docRef);\r\n      setShowModal(false);\r\n      setSelectedAccount(null);\r\n    } catch (err) {\r\n      setError(\"Failed to delete account.\");\r\n    }\r\n  };\r\n\r\n  // The new function that handles adding notes, now in the parent component\r\n  const handleAddNoteToAccount = async (accountId, noteText) => {\r\n    if (!db || !user || !noteText.trim() || !accountId) return false;\r\n    \r\n    try {\r\n      const currentAccount = Object.values(accounts).flat().find(acc => acc.id === accountId);\r\n      if (!currentAccount) return false;\r\n\r\n      const newNote = {\r\n        text: noteText,\r\n        timestamp: new Date().toISOString(),\r\n        sentiment: 'Neutral' // Default sentiment, can be enhanced with AI analysis\r\n      };\r\n      \r\n      const updatedNotes = [...(currentAccount.notes || []), newNote];\r\n\r\n      // Update Firestore\r\n      const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, accountId);\r\n      await updateDoc(docRef, { notes: updatedNotes });\r\n      \r\n      // We don't need to manually update state here, as onSnapshot will do it for us\r\n      return true;\r\n    } catch (err) {\r\n      setError(\"Failed to add note.\");\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const totalPipelineValue = Object.values(accounts).flat().filter(acc => acc.stage !== 'Closed Won' && acc.stage !== 'Closed Lost' && acc.stage !== 'Business Intel').reduce((sum, acc) => sum + (acc.value || 0), 0);\r\n  const numberOfActiveDeals = Object.values(accounts).flat().filter(acc => acc.stage !== 'Closed Won' && acc.stage !== 'Closed Lost' && acc.stage !== 'Business Intel').length;\r\n  const upcomingFollowups = Object.values(accounts).flat().filter(acc => {\r\n    if (!acc.nextFollowUpDate) return false;\r\n    const today = new Date();\r\n    const followUpDate = acc.nextFollowUpDate.toDate();\r\n    const timeDiff = followUpDate.getTime() - today.getTime();\r\n    const dayDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));\r\n    return dayDiff >= 0 && dayDiff <= 7;\r\n  }).length;\r\n\r\n  const getPipelineValues = () => {\r\n    const values = {};\r\n    funnelStages.forEach(stage => {\r\n      values[stage.name] = 0;\r\n    });\r\n    Object.values(accounts).flat().forEach(account => {\r\n      if (account.stage !== 'Closed Won' && account.stage !== 'Closed Lost' && account.stage !== 'Business Intel') {\r\n        values[account.stage] = (values[account.stage] || 0) + (account.value || 0);\r\n      }\r\n    });\r\n    return values;\r\n  };\r\n\r\n  const pipelineValues = getPipelineValues();\r\n  const maxPipelineValue = Math.max(...Object.values(pipelineValues));\r\n\r\n  const handleLogout = async () => {\r\n    await signOut(auth);\r\n    setAccounts({});\r\n    setSelectedAccount(null);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100\">\r\n        <svg className=\"animate-spin -ml-1 mr-3 h-10 w-10 text-blue-500\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n        </svg>\r\n        <div className=\"mt-4 text-gray-700\">Loading CRM...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return <AuthComponent auth={auth} />;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen text-red-500 text-lg p-4 bg-gray-100\">\r\n        {error}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-gray-100 min-h-screen font-sans antialiased\">\r\n      <div className=\"p-6\">\r\n        <header className=\"flex items-center justify-between bg-white shadow-sm p-4 rounded-lg mb-6\">\r\n          <h1 className=\"text-2xl font-bold text-gray-800\">AI Services CRM</h1>\r\n          <div className=\"flex items-center space-x-4\">\r\n            <span className=\"text-sm text-gray-600\">Welcome, {user.displayName || user.email}!</span>\r\n            <button\r\n              onClick={() => { setSelectedAccount(null); setShowModal(true); }}\r\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out transform hover:scale-105\"\r\n            >\r\n              + Add New Account\r\n            </button>\r\n            <button\r\n              onClick={handleLogout}\r\n              className=\"bg-red-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-red-700 transition duration-300 ease-in-out\"\r\n            >\r\n              Logout\r\n            </button>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-6\">\r\n          <div className=\"bg-white p-6 rounded-lg shadow-sm\">\r\n            <p className=\"text-sm font-medium text-gray-500\">Total Pipeline Value</p>\r\n            <p className=\"text-3xl font-bold text-gray-900 mt-1\">${totalPipelineValue.toLocaleString()}</p>\r\n          </div>\r\n          <div className=\"bg-white p-6 rounded-lg shadow-sm\">\r\n            <p className=\"text-sm font-medium text-gray-500\">Number of Active Deals</p>\r\n            <p className=\"text-3xl font-bold text-gray-900 mt-1\">{numberOfActiveDeals}</p>\r\n          </div>\r\n          <div className=\"bg-white p-6 rounded-lg shadow-sm\">\r\n            <p className=\"text-sm font-medium text-gray-500\">Upcoming Follow-ups (7 days)</p>\r\n            <p className=\"text-3xl font-bold text-gray-900 mt-1\">{upcomingFollowups}</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Pipeline Value Chart */}\r\n        <div className=\"bg-white p-6 rounded-lg shadow-sm mb-6\">\r\n          <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Pipeline Value by Stage</h3>\r\n          <div className=\"flex justify-between items-end h-48 w-full\">\r\n            {funnelStages.filter(s => s.name !== 'Closed Won' && s.name !== 'Closed Lost' && s.name !== 'Business Intel').map(stage => (\r\n              <div key={stage.name} className=\"flex flex-col items-center flex-grow mx-1\">\r\n                <div\r\n                  className={`w-full rounded-t-lg transition-all duration-500 ${stage.color}`}\r\n                  style={{ height: `${maxPipelineValue > 0 ? (pipelineValues[stage.name] / maxPipelineValue) * 100 : 0}%` }}\r\n                ></div>\r\n                <div className=\"mt-2 text-xs text-gray-600 text-center\">{stage.name}</div>\r\n                <div className=\"text-sm font-semibold text-gray-800 mt-1\">${(pipelineValues[stage.name] || 0).toLocaleString()}</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex overflow-x-auto gap-4 py-4 scroll-smooth\">\r\n          {funnelStages.map(stage => (\r\n            <div\r\n              key={stage.name}\r\n              className=\"flex-none w-80 min-h-96 bg-gray-200 rounded-lg p-4 shadow-inner\"\r\n              onDragOver={(e) => e.preventDefault()}\r\n              onDrop={(e) => handleDragEnd(e, stage.name)}\r\n            >\r\n              <h2 className={`text-lg font-semibold text-white px-3 py-1 mb-4 rounded-full ${stage.color}`}>{stage.name}</h2>\r\n              <div className=\"space-y-4 min-h-80\">\r\n                {accounts[stage.name]?.map(account => (\r\n                  <div\r\n                    key={account.id}\r\n                    className=\"cursor-grab bg-white p-4 rounded-lg shadow-md transition duration-200 ease-in-out hover:shadow-lg\"\r\n                    draggable\r\n                    onDragStart={(e) => handleDragStart(e, account)}\r\n                    onClick={() => { setSelectedAccount(account); setShowModal(true); }}\r\n                  >\r\n                    <p className=\"font-semibold text-gray-900\">{account.companyName}</p>\r\n                    <p className=\"text-sm text-gray-600 truncate\">{account.servicesNeeded}</p>\r\n                    <div className=\"flex items-center justify-between text-sm mt-2\">\r\n                      <p className=\"text-gray-700 font-bold\">${(account.value || 0).toLocaleString()}</p>\r\n                      <span className={`px-2 py-1 text-xs font-semibold rounded-full ${account.dealScore > 80 ? 'bg-green-200 text-green-800' : account.dealScore > 50 ? 'bg-yellow-200 text-yellow-800' : 'bg-red-200 text-red-800'}`}>\r\n                        Score: {account.dealScore}\r\n                      </span>\r\n                    </div>\r\n                    {account.nextFollowUpDate && (\r\n                      <p className=\"text-xs text-blue-500 mt-2\">Follow up: {account.nextFollowUpDate.toDate().toLocaleDateString()}</p>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {showModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-xl font-bold text-gray-800\">\r\n                {selectedAccount ? 'Edit Account Details' : 'Add New Account'}\r\n              </h3>\r\n              <button onClick={() => setShowModal(false)} className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold\">\r\n                &times;\r\n              </button>\r\n            </div>\r\n            <AccountForm\r\n              account={selectedAccount}\r\n              onSave={selectedAccount ? handleUpdateAccount : handleAddAccount}\r\n              onClose={() => setShowModal(false)}\r\n              onDelete={selectedAccount ? handleDeleteAccount : null}\r\n              onAddNote={handleAddNoteToAccount}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AuthComponent = ({ auth }) => {\r\n  const [isLogin, setIsLogin] = useState(true);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [firstName, setFirstName] = useState('');\r\n  const [lastName, setLastName] = useState('');\r\n  const [authError, setAuthError] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setAuthError(null);\r\n\r\n    if (!isLogin && password !== confirmPassword) {\r\n      setAuthError(\"Passwords do not match.\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (isLogin) {\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n      } else {\r\n        const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n        await updateProfile(userCredential.user, { displayName: `${firstName} ${lastName}` });\r\n      }\r\n    } catch (error) {\r\n      setAuthError(error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-gray-900 bg-opacity-90 flex items-center justify-center p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl p-8 w-full max-w-sm\">\r\n        <h2 className=\"text-2xl font-bold text-center mb-6\">{isLogin ? 'Login' : 'Sign Up'}</h2>\r\n        {authError && (\r\n          <div className=\"bg-red-100 text-red-700 text-sm p-3 rounded-lg mb-4\">\r\n            {authError}\r\n          </div>\r\n        )}\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          {!isLogin && (\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">First Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={firstName}\r\n                  onChange={(e) => setFirstName(e.target.value)}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\"\r\n                  required={!isLogin}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700\">Last Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={lastName}\r\n                  onChange={(e) => setLastName(e.target.value)}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\"\r\n                  required={!isLogin}\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Email</label>\r\n            <input\r\n              type=\"email\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\"\r\n              required\r\n            />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Password</label>\r\n            <input\r\n              type=\"password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\"\r\n              required\r\n            />\r\n          </div>\r\n          {!isLogin && (\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700\">Confirm Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border\"\r\n                required={!isLogin}\r\n              />\r\n            </div>\r\n          )}\r\n          <button\r\n            type=\"submit\"\r\n            className=\"w-full bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out\"\r\n            disabled={loading}\r\n          >\r\n            {loading ? 'Processing...' : (isLogin ? 'Login' : 'Sign Up')}\r\n          </button>\r\n        </form>\r\n        <div className=\"mt-4 text-center\">\r\n          <button\r\n            onClick={() => setIsLogin(!isLogin)}\r\n            className=\"text-sm text-blue-600 hover:underline\"\r\n          >\r\n            {isLogin ? 'Need an account? Sign Up' : 'Already have an account? Login'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AccountForm = ({ account, onSave, onClose, onDelete, onAddNote }) => {\r\n  const [formData, setFormData] = useState({\r\n    companyName: account?.companyName || '',\r\n    servicesNeeded: account?.servicesNeeded || '',\r\n    value: account?.value || '',\r\n    monthlyValue: account?.monthlyValue || '',\r\n    expectedCloseDate: account?.expectedCloseDate?.toDate().toISOString().split('T')[0] || '',\r\n    nextFollowUpDate: account?.nextFollowUpDate?.toDate().toISOString().split('T')[0] || '',\r\n    contactName: account?.contactName || '',\r\n    contactTitle: account?.contactTitle || '',\r\n    contactEmail: account?.contactEmail || '',\r\n    contactPhone: account?.contactPhone || '',\r\n    industry: account?.industry || '',\r\n    website: account?.website || '',\r\n    companySize: account?.companySize || '',\r\n    leadSource: account?.leadSource || '',\r\n    stage: account?.stage || 'Business Intel',\r\n    notes: account?.notes || [],\r\n    lostReason: account?.lostReason || '',\r\n    dealScore: account?.dealScore || 50,\r\n  });\r\n  const [newNote, setNewNote] = useState('');\r\n  const [loadingAI, setLoadingAI] = useState(false);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const recognitionRef = useRef(null);\r\n  const noteRecognitionRef = useRef(null);\r\n  const [isDictatingNotes, setIsDictatingNotes] = useState(false);\r\n  const [isNoteProcessing, setIsNoteProcessing] = useState(false);\r\n  const [dictationStatus, setDictationStatus] = useState('');\r\n  const [liveTranscript, setLiveTranscript] = useState('');\r\n  const [emailDraft, setEmailDraft] = useState('');\r\n  const [agenda, setAgenda] = useState('');\r\nconst [isAddingAccount, setIsAddingAccount] = useState(false);\r\n\r\n// IMPORTANT: For production, move API keys to secure environment variables.\r\nconst callGeminiAPI = async (prompt, mimeType = 'text/plain', inlineData = null, responseSchema = null) => {\r\n  // Use a fallback key for local testing and debug the env value\r\n  const apiKey = process.env.REACT_APP_GEMINI_API_KEY || 'AIzaSyD65roIJWhoE_BzVIlK4orMuV6Lu0KWeVA';\r\n  console.log(\"Attempting API call with key:\", { apiKey, envValue: process.env.REACT_APP_GEMINI_API_KEY });\r\n  if (!apiKey) {\r\n    console.error(\"Gemini API key is missing or invalid. Env value was:\", process.env.REACT_APP_GEMINI_API_KEY);\r\n    return null;\r\n  }\r\n  const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`;\r\n  const headers = { 'Content-Type': 'application/json' };\r\n  \r\n  let payload = {\r\n    contents: [{ parts: [{ text: prompt }] }],\r\n  };\r\n\r\n  if (inlineData) {\r\n    payload.contents[0].parts.push({\r\n      inlineData: { mimeType, data: inlineData },\r\n    });\r\n  }\r\n\r\n  if (responseSchema) {\r\n    payload.generationConfig = { responseMimeType: \"application/json\", responseSchema };\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(apiUrl, {\r\n      method: 'POST',\r\n      headers: headers,\r\n      body: JSON.stringify(payload),\r\n    });\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n    const data = await response.json();\r\n    console.log(\"API Response:\", data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error(\"Gemini API call failed:\", error.message);\r\n    return null;\r\n  }\r\n};\r\n\r\n  const recalculateDealScore = async (data) => {\r\n    if (data.stage === 'Closed Won') return 100;\r\n    if (data.stage === 'Closed Lost') return 0;\r\n    \r\n    const allNotes = data.notes.map(note => ({\r\n      text: note.text,\r\n      sentiment: note.sentiment\r\n    }));\r\n\r\n    const prompt = `Based on the following account details, chronological notes, and its current position in the sales funnel, provide a predictive lead score from 0 to 100. A score of 100 indicates a very high probability of closing.\r\n\r\n    Consider these primary factors:\r\n    1. The deal's progression through the sales funnel. This is the most important indicator.\r\n    2. The combined sentiment of the notes, and the trend of that sentiment over time. Recent positive sentiment is more important than old negative sentiment.\r\n    3. The deal's value and other details including the setup fee and monthly subscription.\r\n\r\n    Account Details:\r\n    Current Stage: ${data.stage}\r\n    Deal Value: $${data.value}\r\n    Monthly Value: $${data.monthlyValue}\r\n    Company Name: ${data.companyName}\r\n\r\n    Chronological History (Notes):\r\n    ${JSON.stringify(allNotes, null, 2)}\r\n    \r\n    Return only the integer score as a number.`;\r\n    \r\n    const scoreText = await callGeminiAPI(prompt, 'text/plain', null, { type: \"NUMBER\" });\r\n    return scoreText ? parseFloat(scoreText) : 50;\r\n  };\r\n\r\n  const handleDraftEmail = async () => {\r\n    setLoadingAI(true);\r\n    setDictationStatus('Drafting email...');\r\n\r\n    const notesSummary = formData.notes.length > 0\r\n      ? formData.notes.map(note => note.text).join('\\n')\r\n      : 'No notes available. The last interaction was for ' + formData.stage;\r\n\r\n    const prompt = `You are a professional sales representative. Draft a concise and personalized follow-up email for a client. The email should be polite, reference the previous interactions, and suggest a clear next step.\r\n\r\n    Account Details:\r\n    Company Name: ${formData.companyName}\r\n    Services Needed: ${formData.servicesNeeded}\r\n    Current Stage: ${formData.stage}\r\n    Primary Contact: ${formData.contactName}\r\n    Notes from previous interactions:\r\n    ${notesSummary}\r\n\r\n    Draft the email, starting with a subject line. Do not include a signature.`;\r\n\r\n    const draft = await callGeminiAPI(prompt);\r\n    if (draft) {\r\n      setEmailDraft(draft);\r\n    } else {\r\n      setEmailDraft(\"Failed to generate email draft. Please try again.\");\r\n    }\r\n    setLoadingAI(false);\r\n    setDictationStatus('');\r\n  };\r\n\r\n  const handleGenerateAgenda = async () => {\r\n    setLoadingAI(true);\r\n    setDictationStatus('Generating agenda...');\r\n\r\n    const notesSummary = formData.notes.length > 0\r\n      ? formData.notes.map(note => note.text).join('\\n')\r\n      : 'No notes available.';\r\n    \r\n    const prompt = `You are a professional sales manager. Generate a concise and scannable meeting agenda for the next sales call. The agenda should be based on the account details and historical notes.\r\n\r\n    Format the response with markdown. Use a single heading, followed by bullet points for each section. Keep each section to a maximum of 3-4 bullet points.\r\n\r\n    ## Meeting Agenda: ${formData.companyName} - ${formData.servicesNeeded}\r\n\r\n    **Objective**\r\n    - [Briefly state the goal of the meeting based on the current stage.]\r\n\r\n    **Key Discussion Points**\r\n    - [Key topics pulled from notes or next steps in the sales funnel.]\r\n    - [Address any customer concerns mentioned in the notes.]\r\n    - [Review of the last interaction.]\r\n\r\n    **Next Steps**\r\n    - [Actionable tasks or commitments to close the deal.]\r\n\r\n    Account Details:\r\n    Current Stage: ${formData.stage}\r\n    Notes from previous interactions:\r\n    ${notesSummary}\r\n    \r\n    Draft the agenda using the structure and content above. Do not include any other text.`;\r\n\r\n    const generatedAgenda = await callGeminiAPI(prompt);\r\n    if (generatedAgenda) {\r\n      setAgenda(marked.parse(generatedAgenda));\r\n    } else {\r\n      setAgenda(\"Failed to generate meeting agenda. Please try again.\");\r\n    }\r\n    setLoadingAI(false);\r\n    setDictationStatus('');\r\n  };\r\n\r\n  const handleScanBusinessCard = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    setLoadingAI(true);\r\n    setDictationStatus('Scanning card...');\r\n    const reader = new FileReader();\r\n    reader.onload = async () => {\r\n      const base64Data = reader.result.split(',')[1];\r\n      const prompt = \"Extract the following information from this business card and return it as a JSON object with keys: companyName, contactName, contactTitle, contactEmail, contactPhone. Only return the JSON object, nothing else.\";\r\n      const jsonText = await callGeminiAPI(prompt, file.type, base64Data);\r\n\r\n      if (jsonText) {\r\n        const parsedData = JSON.parse(jsonText.replace(/```json\\n|\\n```/g, ''));\r\n        setFormData(prev => ({\r\n          ...prev,\r\n          ...parsedData,\r\n          contactName: parsedData.contactName || '',\r\n          contactEmail: parsedData.contactEmail || '',\r\n          contactPhone: parsedData.contactPhone || '',\r\n          contactTitle: parsedData.contactTitle || '',\r\n          companyName: parsedData.companyName || ''\r\n        }));\r\n      } else {\r\n        console.error(\"AI extraction failed: No text in response.\");\r\n      }\r\n      setLoadingAI(false);\r\n      setDictationStatus('');\r\n    };\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const handleDictate = () => {\r\n    if (!('webkitSpeechRecognition' in window)) {\r\n      console.error(\"Speech recognition not supported in this browser.\");\r\n      return;\r\n    }\r\n    const SpeechRecognition = window.webkitSpeechRecognition;\r\n    recognitionRef.current = new SpeechRecognition();\r\n    recognitionRef.current.continuous = true;\r\n    recognitionRef.current.interimResults = true;\r\n    recognitionRef.current.lang = 'en-US';\r\n\r\n    let finalTranscript = '';\r\n\r\n    recognitionRef.current.onstart = () => {\r\n      setLoadingAI(true);\r\n      setDictationStatus('Listening...');\r\n      setLiveTranscript('');\r\n      finalTranscript = '';\r\n    };\r\n    recognitionRef.current.onresult = (event) => {\r\n      let interimTranscript = '';\r\n      for (let i = event.resultIndex; i < event.results.length; ++i) {\r\n        if (event.results[i].isFinal) {\r\n          finalTranscript += event.results[i][0].transcript;\r\n        } else {\r\n          interimTranscript += event.results[i][0].transcript;\r\n        }\r\n      }\r\n      setLiveTranscript(finalTranscript + interimTranscript);\r\n    };\r\n    recognitionRef.current.onend = async () => {\r\n      recognitionRef.current = null;\r\n      if (finalTranscript.trim() === '') {\r\n        setLoadingAI(false);\r\n        setDictationStatus('');\r\n        console.warn(\"Speech recognition ended with no final transcript.\");\r\n        return;\r\n      }\r\n      setDictationStatus('Thinking...');\r\n      const prompt = `Based on the following transcript, extract key information and return a JSON object with keys for companyName, servicesNeeded, value (as a number), monthlyValue (as a number), contactName, contactTitle, contactEmail, and contactPhone. If a value is not found, use a null. Do not include any other text besides the JSON. Transcript: \"${finalTranscript.trim()}\"`;\r\n      const jsonText = await callGeminiAPI(prompt, 'text/plain', null, {\r\n        type: \"OBJECT\",\r\n        properties: {\r\n            \"companyName\": { \"type\": \"STRING\" },\r\n            \"servicesNeeded\": { \"type\": \"STRING\" },\r\n            \"value\": { \"type\": \"NUMBER\" },\r\n            \"monthlyValue\": { \"type\": \"NUMBER\" },\r\n            \"contactName\": { \"type\": \"STRING\" },\r\n            \"contactTitle\": { \"type\": \"STRING\" },\r\n            \"contactEmail\": { \"type\": \"STRING\" },\r\n            \"contactPhone\": { \"type\": \"STRING\" }\r\n        }\r\n      });\r\n\r\n      if (jsonText) {\r\n        const parsedData = JSON.parse(jsonText);\r\n        setFormData(prev => ({\r\n          ...prev,\r\n          ...parsedData,\r\n          value: parsedData.value || '',\r\n          monthlyValue: parsedData.monthlyValue || '',\r\n        }));\r\n      } else {\r\n        console.error(\"AI parsing failed: No text in response.\");\r\n      }\r\n      setLoadingAI(false);\r\n      setDictationStatus('');\r\n    };\r\n    recognitionRef.current.onerror = (event) => {\r\n      if (event.error === 'no-speech') {\r\n        console.warn(\"Speech recognition stopped due to no speech detected.\");\r\n      } else {\r\n        console.error(\"Speech recognition error:\", event.error);\r\n      }\r\n      setDictationStatus('');\r\n      setLoadingAI(false);\r\n    };\r\n    recognitionRef.current.start();\r\n  };\r\n\r\n  const handleStopDictate = () => {\r\n    if (recognitionRef.current) {\r\n      recognitionRef.current.stop();\r\n    }\r\n  };\r\n\r\n  const handleNoteDictate = () => {\r\n      if (!('webkitSpeechRecognition' in window)) {\r\n        console.error(\"Speech recognition not supported in this browser.\");\r\n        return;\r\n      }\r\n      const SpeechRecognition = window.webkitSpeechRecognition;\r\n      noteRecognitionRef.current = new SpeechRecognition();\r\n      noteRecognitionRef.current.continuous = true;\r\n      noteRecognitionRef.current.interimResults = true;\r\n      noteRecognitionRef.current.lang = 'en-US';\r\n\r\n      let finalTranscript = '';\r\n      setIsDictatingNotes(true);\r\n      setNewNote('');\r\n      setLiveTranscript('');\r\n      setDictationStatus('Listening...');\r\n\r\n      noteRecognitionRef.current.onresult = (event) => {\r\n          let interimTranscript = '';\r\n          for (let i = event.resultIndex; i < event.results.length; ++i) {\r\n              if (event.results[i].isFinal) {\r\n                  finalTranscript += event.results[i][0].transcript;\r\n              } else {\r\n                  interimTranscript += event.results[i][0].transcript;\r\n              }\r\n          }\r\n          setLiveTranscript(finalTranscript + interimTranscript);\r\n      };\r\n\r\n      noteRecognitionRef.current.onend = async () => {\r\n          setIsDictatingNotes(false);\r\n          noteRecognitionRef.current = null;\r\n          if (finalTranscript.trim() === '') {\r\n              setNewNote('');\r\n              setIsNoteProcessing(false);\r\n              setDictationStatus('');\r\n              console.warn(\"Speech recognition ended with no final transcript.\");\r\n              return;\r\n          }\r\n          setDictationStatus('Processing...');\r\n          const transcript = finalTranscript.trim();\r\n          \r\n          const prompt = `Analyze the following transcript of a sales call or meeting. Extract and structure the information into three categories: 'summary' (as bullet points), 'actions' (as a list of tasks that need to be done), and 'concerns' (customer issues or questions). Also, classify the overall sentiment of the conversation as 'Positive', 'Negative', or 'Neutral'. Return the result as a JSON object with the keys 'summary', 'actions', 'concerns', and 'sentiment'. If a category has no information, use an empty array. Do not include any text outside of the JSON object.\r\n          Transcript: \"${transcript}\"`;\r\n          const jsonText = await callGeminiAPI(prompt, 'text/plain', null, {\r\n              type: \"OBJECT\",\r\n              properties: {\r\n                  \"summary\": { \"type\": \"ARRAY\", \"items\": { \"type\": \"STRING\" } },\r\n                  \"actions\": { \"type\": \"ARRAY\", \"items\": { \"type\": \"STRING\" } },\r\n                  \"concerns\": { \"type\": \"ARRAY\", \"items\": { \"type\": \"STRING\" } },\r\n                  \"sentiment\": { \"type\": \"STRING\" }\r\n              }\r\n          });\r\n\r\n          if (jsonText) {\r\n              const parsedData = JSON.parse(jsonText);\r\n              let formattedNote = '';\r\n              const sentimentEmoji = parsedData.sentiment === 'Positive' ? 'ðŸ˜Š' : parsedData.sentiment === 'Negative' ? 'ðŸ˜ž' : 'ðŸ˜';\r\n\r\n              formattedNote += `**Sentiment:** ${parsedData.sentiment} ${sentimentEmoji}\\n\\n`;\r\n              if (parsedData.summary.length > 0) {\r\n                  formattedNote += \"**Summary:**\\n\" + parsedData.summary.map(item => `â€¢ ${item}`).join(\"\\n\");\r\n              }\r\n              if (parsedData.actions.length > 0) {\r\n                  formattedNote += (formattedNote ? \"\\n\\n\" : \"\") + \"**Action Items:**\\n\" + parsedData.actions.map(item => `â€¢ ${item}`).join(\"\\n\");\r\n              }\r\n              if (parsedData.concerns.length > 0) {\r\n                  formattedNote += (formattedNote ? \"\\n\\n\" : \"\") + \"**Customer Concerns:**\\n\" + parsedData.concerns.map(item => `â€¢ ${item}`).join(\"\\n\");\r\n              }\r\n              setNewNote(formattedNote);\r\n          } else {\r\n            setNewNote('Failed to process note.');\r\n          }\r\n          setIsNoteProcessing(false);\r\n          setDictationStatus('');\r\n          setLiveTranscript('');\r\n      };\r\n\r\n      noteRecognitionRef.current.onerror = (event) => {\r\n          if (event.error === 'no-speech') {\r\n            console.warn(\"Speech recognition for notes stopped due to no speech detected.\");\r\n          } else {\r\n            console.error(\"Speech recognition error:\", event.error);\r\n          }\r\n          setIsDictatingNotes(false);\r\n          setIsNoteProcessing(false);\r\n          setDictationStatus('');\r\n          setNewNote('');\r\n          setLiveTranscript('');\r\n      };\r\n      noteRecognitionRef.current.start();\r\n  };\r\n\r\n  const handleStopNoteDictate = () => {\r\n    if (noteRecognitionRef.current) {\r\n      noteRecognitionRef.current.stop();\r\n    }\r\n  };\r\n\r\n  const handleEditNote = (index, newNoteContent) => {\r\n    const updatedNotes = [...formData.notes];\r\n    updatedNotes[index] = { ...updatedNotes[index], text: newNoteContent };\r\n    setFormData(prev => ({ ...prev, notes: updatedNotes }));\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleAddNote = async () => {\r\n    if (newNote.trim() === '' || !selectedAccount) return;\r\n    \r\n    // Create a new note object with a timestamp and the user's name\r\n    const noteWithTimestamp = { text: newNote, timestamp: new Date().toISOString() };\r\n    \r\n    // Create a new notes array by copying the old ones and adding the new one\r\n    const updatedNotes = [...(selectedAccount.notes || []), noteWithTimestamp];\r\n\r\n    // Get a reference to the document to be updated\r\n    const docRef = doc(db, `artifacts/${appId}/users/${user.uid}/accounts`, selectedAccount.id);\r\n\r\n    // Update the notes field in Firestore\r\n    await updateDoc(docRef, { notes: updatedNotes });\r\n\r\n    // Update the local state with the new note and clear the input field\r\n    setSelectedAccount(prev => ({ ...prev, notes: updatedNotes }));\r\n    setNewNote('');\r\n  };\r\n\r\n  const handleSave = async (e) => {\r\n      e.preventDefault();\r\n      setIsAddingAccount(true);\r\n      const updatedFormData = { ...formData };\r\n      if (updatedFormData.stage === 'Business Intel' && !updatedFormData.servicesNeeded) {\r\n        updatedFormData.servicesNeeded = 'N/A';\r\n      }\r\n      try {\r\n        const newDealScore = await recalculateDealScore(updatedFormData);\r\n        updatedFormData.dealScore = newDealScore;\r\n        await onSave(updatedFormData);\r\n      } finally {\r\n        setIsAddingAccount(false);\r\n      }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSave} className=\"space-y-4\">\r\n      <div className=\"flex items-center space-x-4 mb-4\">\r\n        <label className={`relative flex items-center px-4 py-2 rounded-full cursor-pointer transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>\r\n          <input type=\"file\" accept=\"image/*\" onChange={handleScanBusinessCard} className=\"absolute inset-0 opacity-0 cursor-pointer\" disabled={loadingAI} />\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-2\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n            <path fillRule=\"evenodd\" d=\"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\" clipRule=\"evenodd\" />\r\n          </svg>\r\n          Scan Business Card\r\n        </label>\r\n        {!recognitionRef.current ? (\r\n          <button type=\"button\" onClick={handleDictate} className={`flex items-center px-4 py-2 rounded-full transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`} disabled={loadingAI}>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-2\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path d=\"M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H2V5z\" />\r\n            </svg>\r\n            Dictate\r\n          </button>\r\n        ) : (\r\n          <button type=\"button\" onClick={handleStopDictate} className=\"flex items-center px-4 py-2 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-2 animate-pulse\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <circle cx=\"10\" cy=\"10\" r=\"8\" />\r\n            </svg>\r\n            Stop\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {dictationStatus && <div className=\"text-blue-600 text-sm font-semibold mb-4\">{dictationStatus}</div>}\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Company Name</label>\r\n          <input type=\"text\" name=\"companyName\" value={formData.companyName} onChange={handleChange} required className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Services Needed</label>\r\n          <input type=\"text\" name=\"servicesNeeded\" value={formData.servicesNeeded} onChange={handleChange} required className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Deal Value ($)</label>\r\n          <input type=\"number\" name=\"value\" value={formData.value} onChange={handleChange} required className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Monthly Value ($)</label>\r\n          <input type=\"number\" name=\"monthlyValue\" value={formData.monthlyValue} onChange={handleChange} required className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Expected Close Date</label>\r\n          <input type=\"date\" name=\"expectedCloseDate\" value={formData.expectedCloseDate} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Next Follow-up Date</label>\r\n          <input type=\"date\" name=\"nextFollowUpDate\" value={formData.nextFollowUpDate} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Primary Contact</label>\r\n          <input type=\"text\" name=\"contactName\" value={formData.contactName} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Contact Title</label>\r\n          <input type=\"text\" name=\"contactTitle\" value={formData.contactTitle} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Contact Email</label>\r\n          <input type=\"email\" name=\"contactEmail\" value={formData.contactEmail} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Contact Phone</label>\r\n          <input type=\"tel\" name=\"contactPhone\" value={formData.contactPhone} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Industry</label>\r\n          <input type=\"text\" name=\"industry\" value={formData.industry} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">Lead Source</label>\r\n          <input type=\"text\" name=\"leadSource\" value={formData.leadSource} onChange={handleChange} className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" />\r\n        </div>\r\n        {formData.stage === 'Closed Lost' && (\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium text-gray-700\">Reason for Losing</label>\r\n            <textarea name=\"lostReason\" value={formData.lostReason} onChange={handleChange} required className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\" rows=\"3\"></textarea>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {account && (\r\n        <div className=\"mt-6\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleDraftEmail}\r\n            className=\"flex items-center justify-center w-full bg-indigo-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-indigo-700 transition duration-300 ease-in-out\"\r\n            disabled={loadingAI}\r\n          >\r\n            âœ¨ AI Draft Email\r\n          </button>\r\n          {emailDraft && (\r\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\">\r\n              <h4 className=\"text-sm font-semibold mb-2\">Email Draft:</h4>\r\n              <textarea\r\n                value={emailDraft}\r\n                readOnly\r\n                className=\"w-full text-sm text-gray-800 bg-transparent border-none focus:outline-none\"\r\n                rows=\"10\"\r\n              ></textarea>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  try {\r\n                    navigator.clipboard.writeText(emailDraft);\r\n                  } catch (e) {\r\n                    const tempInput = document.createElement('textarea');\r\n                    tempInput.value = emailDraft;\r\n                    document.body.appendChild(tempInput);\r\n                    tempInput.select();\r\n                    document.execCommand('copy');\r\n                    document.body.removeChild(tempInput);\r\n                  }\r\n                }}\r\n                className=\"mt-2 text-xs text-blue-600 hover:underline\"\r\n              >\r\n                Copy to Clipboard\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {account && (\r\n        <div className=\"mt-6\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleGenerateAgenda}\r\n            className=\"flex items-center justify-center w-full bg-teal-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-teal-700 transition duration-300 ease-in-out\"\r\n            disabled={loadingAI}\r\n          >\r\n            âœ¨ AI Generate Agenda\r\n          </button>\r\n          {agenda && (\r\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200\">\r\n              <h4 className=\"text-sm font-semibold mb-2\">Meeting Agenda:</h4>\r\n              <div\r\n                className=\"prose prose-sm w-full max-w-none text-sm text-gray-800 bg-transparent border-none focus:outline-none\"\r\n                dangerouslySetInnerHTML={{ __html: agenda }}\r\n              ></div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  try {\r\n                    navigator.clipboard.writeText(agenda);\r\n                  } catch (e) {\r\n                    const tempInput = document.createElement('textarea');\r\n                    tempInput.value = agenda;\r\n                    document.body.appendChild(tempInput);\r\n                    tempInput.select();\r\n                    document.execCommand('copy');\r\n                    document.body.removeChild(tempInput);\r\n                  }\r\n                }}\r\n                className=\"mt-2 text-xs text-blue-600 hover:underline\"\r\n              >\r\n                Copy to Clipboard\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {account && (\r\n        <div className=\"mt-6\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Activity & Notes</label>\r\n          <div className=\"border border-gray-300 rounded-md p-3 max-h-48 overflow-y-auto mt-1\">\r\n            {formData.notes.map((note, index) => (\r\n              <div key={index} className=\"text-sm text-gray-700 mb-2 p-2 bg-gray-50 rounded-md group relative\">\r\n                <p>{note.text}</p>\r\n                <p className=\"text-xs text-gray-400 mt-1\">{new Date(note.timestamp).toLocaleString()} | <span className={`font-semibold ${note.sentiment === 'Positive' ? 'text-green-600' : note.sentiment === 'Negative' ? 'text-red-600' : 'text-gray-600'}`}>{note.sentiment}</span></p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          <div className=\"flex items-center mt-2\">\r\n            <textarea\r\n              value={isDictatingNotes ? liveTranscript : newNote}\r\n              onChange={(e) => setNewNote(e.target.value)}\r\n              placeholder={isDictatingNotes ? 'Speaking...' : (isNoteProcessing ? 'Processing...' : 'Add a new note...')}\r\n              className=\"flex-grow rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2 border\"\r\n              disabled={isNoteProcessing}\r\n              rows={isDictatingNotes ? 4 : 1}\r\n            />\r\n            {!isDictatingNotes ? (\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleNoteDictate}\r\n                className={`ml-2 flex items-center px-4 py-2 rounded-full transition-colors ${loadingAI ? 'bg-gray-400 text-white' : 'bg-blue-600 text-white hover:bg-blue-700'}`}\r\n                disabled={loadingAI || isNoteProcessing}\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M7 4a3 3 0 00-3 3v6a3 3 0 003 3h6a3 3 0 003-3V7a3 3 0 00-3-3H7zm0 2a1 1 0 00-1 1v6a1 1 0 001 1h6a1 1 0 001-1V7a1 1 0 00-1-1H7z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n            ) : (\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleStopNoteDictate}\r\n                className=\"ml-2 flex items-center px-4 py-2 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 animate-pulse\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <circle cx=\"10\" cy=\"10\" r=\"8\" />\r\n                </svg>\r\n              </button>\r\n            )}\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onAddNote(account.id, newNote)}\r\n              className=\"ml-2 bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300 ease-in-out\"\r\n              disabled={isNoteProcessing || isDictatingNotes || !newNote.trim()}\r\n            >\r\n              Add Note\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex justify-end space-x-2 mt-6\">\r\n        {onDelete && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setShowDeleteConfirm(true)}\r\n            className=\"bg-red-600 text-white px-6 py-3 rounded-full shadow-md hover:bg-red-700 transition duration-300 ease-in-out\"\r\n          >\r\n            Delete\r\n          </button>\r\n        )}\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"bg-gray-300 text-gray-800 px-6 py-3 rounded-full shadow-md hover:bg-gray-400 transition duration-300 ease-in-out\"\r\n        >\r\n          Cancel\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"bg-green-600 text-white px-6 py-3 rounded-full shadow-md hover:bg-green-700 transition duration-300 ease-in-out\"\r\n          disabled={isAddingAccount}\r\n        >\r\n          {isAddingAccount ? (\r\n            <svg className=\"animate-spin h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n            </svg>\r\n          ) : (\r\n            account ? 'Save Changes' : 'Add Account'\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {showDeleteConfirm && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-sm p-6 relative\">\r\n            <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Confirm Deletion</h3>\r\n            <p className=\"text-gray-600 mb-6\">Are you sure you want to delete this account? This action cannot be undone.</p>\r\n            <div className=\"flex justify-end space-x-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowDeleteConfirm(false)}\r\n                className=\"bg-gray-300 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-400 transition duration-300\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  onDelete(account.id);\r\n                  setShowDeleteConfirm(false);\r\n                }}\r\n                className=\"bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700 transition duration-300\"\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}